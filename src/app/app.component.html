<app-splash-screen *ngIf="!isUserLogged"
  (connectRequest)="onConnectRequest($event)"></app-splash-screen>

<div *ngIf="isUserLogged" class="container" fxLayout="column" fxLayoutAlign="start stretch">

  <mat-toolbar color="primary" fxLayout="row" fxLayoutAlign="start center" class="mat-elevation-z4">
    <button mat-flat-button color="primary" class="menu-button" (click)="sidenav.toggle()">
      <mat-icon>menu</mat-icon>
    </button>
    <div fxLayout="row" fxLayoutAlign="center center">
          <span [matBadge]="chatManager.chat().stats.messages.new"
                matBadgeColor="accent"
                [matBadgeHidden]="!(chatManager && chatManager.chat().target().name && chatManager.chat().stats.messages.new > 0)"
                matBadgeOverlap="false">{{ chatManager && chatManager.chat().target().name || 'NgWebIRC' }}</span>
    </div>
    <span class="flex-fill"></span>
    <div class="right-toolbar">
      <button mat-icon-button class="icon-big" *ngIf="chatManager.channel()"
              matTooltip="Utenti"
              (click)="onChannelButtonClick(chatManager)"
              [matBadge]="chatManager.channel().users.length"
              matBadgePosition="after" matBadgeColor="primary">
        <mat-icon>people_alt</mat-icon>
      </button>
      <button mat-icon-button class="icon-big"
              matTooltip="Messaggi"
              (click)="chatManager.showChatList()"
              [matBadge]="chatManager.newMessageCount()"
              [matBadgeHidden]="chatManager.newMessageCount() === 0 || (!chatManager.showUserList && chatManager.showRightPanel)"
              matBadgePosition="after" matBadgeColor="accent">
        <mat-icon>forum</mat-icon>
      </button>
    </div>
  </mat-toolbar>

  <mat-sidenav-container [hasBackdrop]="screenWidth < sideOverBreakPoint">

    <mat-sidenav-content>

      <div class="content" fxLayout="column" fxLayoutAlign="start stretch">

        <app-chat-manager #chatManager [loginInfo]="loginInfo"></app-chat-manager>

      </div>

    </mat-sidenav-content>

    <mat-sidenav #sidenav class="left-panel mat-elevation-z3"
                 [mode]="screenWidth < sideOverBreakPoint ? 'over' : 'side'"
                 [opened]="screenWidth > 1024 ? true : false" position="start"
                 fxLayout="column">

      <h4>{{ chatManager.ircClient.config.nick }}</h4>

      <button mat-flat-button disabled>
        <mat-icon color="primary">announcement</mat-icon>
        <span>Descrivi un azione</span>
      </button>
      <button mat-flat-button disabled>
        <mat-icon color="primary">speaker_notes_off</mat-icon>
        <span>Imposta assente</span>
      </button>
      <button mat-flat-button disabled>
        <mat-icon color="primary">autorenew</mat-icon>
        <span>Cambia nome</span>
      </button>

      <label>Preferenze interfaccia</label>

      <mat-checkbox *ngIf="chatManager.channel()"
                    [checked]="chatManager.channel().preferences.showChannelActivity"
                    (change)="chatManager.channel().preferences.showChannelActivityToggle()">Mostra in/out</mat-checkbox>
      <mat-checkbox disabled>Tema scuro</mat-checkbox>

      <label>Server</label>

      <button mat-flat-button (click)="onDisconnectClick()">
        <mat-icon color="warn">exit_to_app</mat-icon>
        <span>Disconnetti</span>
      </button>

    </mat-sidenav>

  </mat-sidenav-container>

</div>



